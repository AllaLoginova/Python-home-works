import telebot
import random

token = ''
bot = telebot.TeleBot(token)

user_state = ''
count = 0
bot_number = random.randint(1, 5)


@bot.message_handler(commands=['start'])
def start(message):
    bot.send_message(message.chat.id, f"–ü—Ä–∏–≤–µ—Ç, {message.from_user.first_name}")


@bot.message_handler(commands=['game'])
def game(message):
    global user_state
    user_state = 'game'
    bot.send_message(message.chat.id, '–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ —è –∑–∞–≥–∞–¥–∞–ª\n–í–≤–µ–¥–∏ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 5')


@bot.message_handler(content_types=['text'])
def get_user_number(message):
    global count, user_state, bot_number

    if user_state == 'game':
        print(bot_number)
        try:
            user_number = int(message.text.strip())
            if bot_number == user_number:
                bot.reply_to(message, f"–£–≥–∞–¥–∞–ª! –ü–æ–ø—ã—Ç–æ–∫ –±—ã–ª–æ: {count}")
                user_state = ''
                bot_number = random.randint(1, 5)
                count = 0

            else:
                bot.send_message(message.chat.id, '–ù–µ —É–≥–∞–¥–∞–ªüò¢')
                count += 1

        except Exception:
            bot.send_message(message.chat.id, f"üòí –≠—Ç–æ –Ω–µ —á–∏—Å–ª–æ...")


bot.infinity_polling()
# bot.polling(non_stop=True)
